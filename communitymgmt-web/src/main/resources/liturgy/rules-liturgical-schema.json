{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "LiturgyRules",
  "type": "object",

  "properties": {
    "rules": {
      "type": "array",
      "items": { "$ref": "#/definitions/LiturgyRule" }
    }
  },

  "required": ["rules"],

  "definitions": {

    "LiturgyRule": {
      "type": "object",
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" },

        "type": {
          "type": "string",
          "enum": [
            "FIXED_FEAST",
            "COMPUTUS_FEAST",
            "DEPENDENT_FEAST"
          ]
        },

        "date": { "$ref": "#/definitions/FixedDate" },
        "computus": { "$ref": "#/definitions/ComputusDefinition" },
        "relation": { "$ref": "#/definitions/RelationDefinition" },

        "adjustments": {
          "type": "array",
          "items": { "$ref": "#/definitions/Adjustment" }
        }
      },

      "required": ["id", "name", "type"]
    },

    "FixedDate": {
      "type": "object",
      "properties": {
        "month": { "type": "integer", "minimum": 1, "maximum": 12 },
        "day":   { "type": "integer", "minimum": 1, "maximum": 31 }
      },
      "required": ["month", "day"]
    },

    "ComputusDefinition": {
      "type": "object",
      "properties": {
        "method": {
          "type": "string",
          "enum": ["EASTER_WESTERN"]
        }
      },
      "required": ["method"]
    },

    "RelationDefinition": {
      "type": "object",
      "properties": {
        "base": { "type": "string" },
        "shift": {
          "type": "object",
          "properties": {
            "days": { "type": "integer" }
          },
          "required": ["days"]
        }
      },
      "required": ["base", "shift"]
    },

    "Adjustment": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": [
            "MOVE_IF_SUNDAY",
            "MOVE_IF_WEEKDAY",
            "MOVE_TO_NEXT_SUNDAY",
            "MOVE_TO_PREVIOUS_SUNDAY",
            "MOVE_TO_NEXT_WEEKDAY",
            "MOVE_TO_PREVIOUS_WEEKDAY",
            "CLAMP_TO_RANGE",
            "SHIFT_IF_BEFORE",
            "SHIFT_IF_AFTER"
          ]
        },
        "parameters": { "$ref": "#/definitions/AdjustmentParameters" }
      },
      "required": ["type"]
    },

    "AdjustmentParameters": {
      "type": "object",

      "properties": {

        "weekday": {
          "type": "string",
          "enum": [
            "MONDAY", "TUESDAY", "WEDNESDAY",
            "THURSDAY", "FRIDAY", "SATURDAY", "SUNDAY"
          ]
        },

        "distance": { "type": "integer" },

        "start": { "$ref": "#/definitions/FixedDate" },
        "end":   { "$ref": "#/definitions/FixedDate" },

        "reference": { "type": "string" }
      }
    }
  }
}
